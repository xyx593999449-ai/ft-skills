# 更新履历 (CHANGELOG)

本文件用于记录 `bigpoi-verification` skill 包的所有重大变更、修复与改进。

## [1.0.2] - 2026-02-04

### 修复 (Fixed)
- **情报收集实现修复**: 修复 `scripts/collect_evidence.py` 中的关键问题 - 将所有模拟数据收集替换为真实多源 API 集成，确保实际从外部数据源获取 POI 信息而非返回硬编码数据。
  - 替换了 `_collect_from_map_api()` 的模拟实现，改为真实调用高德/百度/腾讯地图 API。
  - 替换了 `_collect_from_web_crawler()` 的模拟实现，改为真实调用网页爬虫服务（地址：`http://10.82.122.209:9081`）。
  - 替换了 `_collect_from_official_source()` 的硬编码返回值，改为调用实际的官方渠道 API（卫健、政府、警务、司法系统）。
  - 替换了 `_collect_from_internet()` 的空壳实现，改为真实获取网络信息源（百度百科、维基百科、好大夫等）。

### 变更 (Changed)
- **执行性能特征**: 数据收集流程从即时返回（<100ms）变更为真实网络异步请求（5-30s），反映真实的多源并行数据获取延迟。
- **证据数据质量**: 收集的证据从静态模拟数据改为真实 API 响应数据，包括实际的 POI 名称、地址、坐标、电话、分类等信息。
- **错误处理策略**: 新增了针对网络超时、API 限流、源不可用等情况的容错机制和降级处理。

### 新增 (Added)
- **高德地图 API 集成** (`_call_amap()` 方法): 直接调用高德地图 POI 搜索 API，解析并返回实际的 POI 数据。
- **百度地图 API 集成** (`_call_baidu_map()` 方法): 集成百度地图地点搜索 API，获取真实的位置数据。
- **腾讯地图 API 集成** (`_call_qq_map()` 方法): 集成腾讯地图搜索服务 API。
- **爬虫服务集成** (`_call_web_crawler()` 方法): 调用专业网页爬虫服务进行目标网页内容提取和信息采集。
- **官方渠道 API 集成** (`_call_official_api()` 方法): 统一处理卫健系统、政府数据、警务系统、司法系统的官方数据源接口。
- **网络信息源集成** (`_call_internet_source()` 方法): 统一接口支持百度百科、维基百科、好大夫等多个网络信息平台的数据获取。
- **平台特定方法**: 新增 `_call_baidu_baike()`, `_call_wikipedia()`, `_call_haodf()` 等专有方法用于各信息源的特定 API 调用逻辑。

### 影响范围
- **主要修改文件**: `scripts/collect_evidence.py`
- **接口兼容性**: 保持完全向后兼容，API 入参和出参格式未变更
- **性能影响**: 由于引入真实网络请求，单次验证执行时间增加 5-30 秒（来自网络延迟），建议在实际部署时进行超时和并发控制配置

## [1.0.1] - 2026-02-03

### 修复 (Fixed)
- **配置文件命名**: 将 `config/skill.ymal` 重命名为正确的 `config/skill.yaml`，修复由于拼写错误导致的 Skill 无法识别问题。

### 变更 (Changed)
- **数据源配置增强**: 在 `config/sources.yaml` 中引入了 `credentials` 全局凭据资源池结构。
- **API Key 资源池化**: 支持为百度、高德、腾讯地图配置多个 API Key 列表。
- **Referer 绑定支持**: 升级凭据存储结构，支持为每个 API Key 单独配置可选的 `referer` 字段。
- **字段名适配**: 适配厂商命名习惯，高德/百度使用 `ak` 字段，腾讯保持使用 `key` 字段。
- **引用机制优化**: 数据源通过 `api_key_ref` 标识符关联至对应的凭据池。

### 评审 (Review)
- 完成了对整个 Skill 包的深度技术评审，确认了其纯规则引擎（零 Token 消耗）的特性，并提出了引入 LLM 混合模式处理复杂语义别名的优化建议。
